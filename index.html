<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Kanji Esperanto Editor (Monaco)</title>
  <meta name="description" content="Kanji Esperanto input demo using Monaco Editor" />
  <style>
    html, body, #app { height: 100%; margin: 0; }
    #app { display: grid; grid-template-rows: auto 1fr; }
    header {
      position: sticky; top: 0; z-index: 1000;
      display:flex; align-items:center; gap:12px; padding: calc(env(safe-area-inset-top, 0px) + 8px) 16px 8px;
      border-bottom:1px solid #ddd; flex-wrap: wrap; background:#fff;
    }
    header strong { font-size: 16px; }
    .hint { font-size: 12px; color: #666; }
    .toolbar { display:flex; gap:8px; flex-wrap: wrap; max-width: 100%; overflow-x: auto; -webkit-overflow-scrolling: touch; }
    .toolbar button { font-size: 12px; padding:6px 10px; border:1px solid #ccc; background:#f8f8f8; border-radius:6px; }
    .toolbar button:active { background:#eee; }
    .toast { font-size: 12px; color:#0a7; margin-left: auto; white-space: nowrap; }
    #editor { height: 100%; }
    #ke-plain { grid-row: 2; grid-column: 1; }
    footer { font-size: 12px; color:#666; padding: 8px 16px; border-top: 1px solid #eee; }
  </style>
  <script>
    // Self-contained worker via data URL so the page works from static hosting
    window.MonacoEnvironment = { getWorkerUrl: function (_moduleId, label) {
      return `data:text/javascript;charset=utf-8,${encodeURIComponent(`
        self.MonacoEnvironment = { baseUrl: 'https://unpkg.com/monaco-editor@0.52.0/min/' };
        importScripts('https://unpkg.com/monaco-editor@0.52.0/min/vs/base/worker/workerMain.js');
      `)}`;
    }};
  </script>
  <link rel="manifest" href="./manifest.webmanifest">
  <script src="https://unpkg.com/monaco-editor@0.52.0/min/vs/loader.js"></script>
</head>
<body>
  <div id="app">
    <header>
      <strong>Kanji Esperanto Editor</strong>
      <span class="hint">スマホは上のボタンでコピペ可能</span>
      <div class="toolbar">
        <button id="btn-copy" type="button">コピー</button>
        <button id="btn-paste" type="button">ペースト</button>
        <button id="btn-select-all" type="button">全選択</button>
        <button id="btn-share" type="button">共有</button>
        <button id="btn-plain-toggle" type="button">シンプル編集</button>
      </div>
      <span id="ke-toast" class="toast" aria-live="polite"></span>
    </header>
    <div id="editor" data-options='{"wordBasedSuggestions":false,"quickSuggestions":{"other":false,"comments":false,"strings":false},"quickSuggestionsDelay":10,"suggest":{"showSnippets":true,"showWords":false}}'></div>
  </div>

  <!-- Small dictionary (override with your real data or use data/ lazy buckets) -->
  <script src="./ke-snippets.js"></script>
  <script src="./app.js"></script>

  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js').catch(()=>{});
      });
    }
  </script>

  <footer>
    © 2025 — Monaco Editor (MIT). 辞書の出典/ライセンスは README を参照。 | v2025-01-16-002
  </footer>
</body>
</html>
